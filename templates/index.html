<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Processing</title>
</head>
<body>
    <h1>Image Processing</h1>
    <form id="imageForm" enctype="multipart/form-data">
        <label for="image">Choose an image:</label>
        <input type="file" id="image" name="image" accept="image/*" required>
        <br><br>

        <label for="brightness">Brightness:</label>
        <input type="range" id="brightness" name="brightness" min="-100" max="100" value="0">
        <span id="brightnessValue">0</span>
        <br><br>

        <label for="contrast">Contrast:</label>
        <input type="range" id="contrast" name="contrast" min="-100" max="100" value="0">
        <span id="contrastValue">0</span>
        <br><br>

        <label for="saturation">Saturation:</label>
        <input type="range" id="saturation" name="saturation" min="0.0" max="3.0" step="0.1" value="1.0">
        <span id="saturationValue">1.0</span>
        <br><br>

        <label for="cartoonize">Cartoonize:</label>
        <input type="checkbox" id="cartoonize" name="cartoonize" value="true">
        <br><br>

        <label for="black_and_white">Black & White:</label>
        <input type="checkbox" id="black_and_white" name="black_and_white" value="true">
        <br><br>

        <button type="button" id="processButton">Upload and Process</button>
    </form>

    <h2>Result:</h2>
    <img id="resultImage" alt="Processed image will appear here" style="max-width: 100%; border: 1px solid black;">

    <script>
        const form = document.getElementById('imageForm');
        const processButton = document.getElementById('processButton');
        const resultImage = document.getElementById('resultImage');

        // Update slider values in real-time
        document.querySelectorAll('input[type="range"]').forEach(slider => {
            slider.addEventListener('input', (event) => {
                const valueSpan = document.getElementById(slider.id + "Value");
                valueSpan.textContent = event.target.value;
            });
        });

        // Handle form submission
        processButton.addEventListener('click', async () => {
            const formData = new FormData(form);

            // Include checkbox values
            formData.append('cartoonize', document.getElementById('cartoonize').checked);
            formData.append('black_and_white', document.getElementById('black_and_white').checked);

            const response = await fetch('/cartoonize', {
                method: 'POST',
                body: formData
            });

            if (response.ok) {
                const blob = await response.blob();
                const imageUrl = URL.createObjectURL(blob);
                resultImage.src = imageUrl;
            } else {
                alert("Error processing image!");
            }
        });
    </script>
</body>
</html>
